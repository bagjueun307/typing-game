<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>위치 교대 타자 대결</title>
    <style>
        body { background: #1a1a1a; color: white; display: flex; flex-direction: column; align-items: center; font-family: 'Malgun Gothic', sans-serif; margin: 0; overflow: hidden; height: 100vh; justify-content: center; }
        
        /* 전체 레이아웃 (좌우 반전을 위해 flex-direction 사용) */
        #main-wrapper { display: flex; gap: 40px; align-items: center; transition: all 0.5s ease; padding: 40px; border-radius: 20px; }
        
        /* 입력창 영역 */
        .player-zone { display: flex; flex-direction: column; align-items: center; width: 250px; padding: 30px; border-radius: 20px; transition: all 0.5s ease; }
        .p1-zone { background: rgba(52, 152, 219, 0.15); border: 3px solid #3498db; box-shadow: 0 0 20px rgba(52, 152, 219, 0.3); }
        .p2-zone { background: rgba(231, 76, 60, 0.15); border: 3px solid #e74c3c; box-shadow: 0 0 20px rgba(231, 76, 60, 0.3); }

        .score { font-size: 4rem; font-weight: bold; margin: 15px 0; }
        .player-label { font-size: 1.5rem; font-weight: bold; margin-bottom: 10px; }
        input { width: 100%; padding: 15px; font-size: 1.3rem; border-radius: 10px; border: none; outline: none; text-align: center; background: #fff; }
        
        /* 4x4 보드 */
        .board { 
            display: grid; 
            grid-template-columns: repeat(4, 140px); 
            grid-template-rows: repeat(4, 100px); 
            gap: 15px; 
            background: #333; 
            padding: 20px; 
            border-radius: 15px;
            box-shadow: 0 0 40px rgba(0,0,0,0.7);
        }

        .cell {
            background: #f0f0f0; color: #222;
            display: flex; align-items: center; justify-content: center;
            border-radius: 10px; font-weight: bold; font-size: 1.4rem;
            transition: transform 0.2s, background 0.3s;
            border-bottom: 6px solid #bbb;
        }

        .cell.p1-owned { background: #3498db; color: white; border-bottom: 6px solid #2980b9; transform: scale(1.03); }
        .cell.p2-owned { background: #e74c3c; color: white; border-bottom: 6px solid #c0392b; transform: scale(1.03); }

        /* 타이머 디자인 */
        #timer-container { margin-bottom: 20px; text-align: center; }
        #timer-bar { width: 300px; height: 10px; background: #444; border-radius: 5px; margin-top: 10px; position: relative; overflow: hidden; }
        #timer-fill { width: 100%; height: 100%; background: #f1c40f; transition: width 0.1s linear; }
    </style>
</head>
<body>

    <div id="timer-container">
        <div style="font-size: 1.2rem; color: #f1c40f;">⚠️ <span id="time-msg">10</span>초 후 위치가 바뀝니다! ⚠️</div>
        <div id="timer-bar"><div id="timer-fill"></div></div>
    </div>
    
    <div id="main-wrapper">
        <div id="p1-area" class="player-zone p1-zone">
            <div class="player-label">PLAYER 1 (Blue)</div>
            <div class="score" id="p1-score">0</div>
            <input type="text" id="p1-input" placeholder="입력!" autofocus>
        </div>

        <div class="board" id="board"></div>

        <div id="p2-area" class="player-zone p2-zone">
            <div class="player-label">PLAYER 2 (Red)</div>
            <div class="score" id="p2-score">0</div>
            <input type="text" id="p2-input" placeholder="입력!">
        </div>
    </div>

    <script>
        const words = ["사과", "바나나", "포도", "딸기", "수박", "오렌지", "망고", "키위", "노트북", "마우스", "키보드", "모니터", "책상", "의자", "거울", "시계", "안경", "지갑", "우산", "신발", "지우개", "연필", "학교", "바다"];
        let boardData = [];
        let timeLeft = 10;
        let isSwapped = false;

        const mainWrapper = document.getElementById('main-wrapper');
        const boardEl = document.getElementById('board');
        const timerFill = document.getElementById('timer-fill');
        const timeMsg = document.getElementById('time-msg');

        function initGame() {
            boardData = [];
            let shuffleWords = [...words].sort(() => Math.random() - 0.5);
            for (let i = 0; i < 16; i++) {
                boardData.push({ word: shuffleWords[i], owner: null });
            }
            renderBoard();
            startRotationTimer();
        }

        function renderBoard() {
            boardEl.innerHTML = '';
            let s1 = 0, s2 = 0;
            boardData.forEach((data) => {
                const cell = document.createElement('div');
                cell.className = 'cell';
                if (data.owner === 'p1') { cell.classList.add('p1-owned'); s1++; }
                else if (data.owner === 'p2') { cell.classList.add('p2-owned'); s2++; }
                cell.innerText = data.word;
                boardEl.appendChild(cell);
            });
            document.getElementById('p1-score').innerText = s1;
            document.getElementById('p2-score').innerText = s2;

            if (s1 + s2 === 16) {
                const winner = s1 > s2 ? "1P(Blue)" : (s2 > s1 ? "2P(Red)" : "무승부");
                alert(`게임 종료! ${winner} 승리!`);
                location.reload();
            }
        }

        // 입력 처리
        function handleInput(e, player) {
            if (e.key === 'Enter') {
                const val = e.target.value.trim();
                const target = boardData.find(d => d.word === val && d.owner !== player);
                if (target) {
                    target.owner = player;
                    renderBoard();
                }
                e.target.value = '';
            }
        }

        document.getElementById('p1-input').addEventListener('keypress', (e) => handleInput(e, 'p1'));
        document.getElementById('p2-input').addEventListener('keypress', (e) => handleInput(e, 'p2'));

        // 위치 변경 타이머 로직
        function startRotationTimer() {
            setInterval(() => {
                timeLeft -= 0.1;
                if (timeLeft <= 0) {
                    swapPlayers();
                    timeLeft = 10;
                }
                timerFill.style.width = (timeLeft / 10) * 100 + "%";
                timeMsg.innerText = Math.ceil(timeLeft);
            }, 100);
        }

        function swapPlayers() {
            isSwapped = !isSwapped;
            // flex-direction을 이용해 좌우 위치를 통째로 바꿈
            mainWrapper.style.flexDirection = isSwapped ? "row-reverse" : "row";
            
            // 시각적 피드백: 바뀌는 순간 강조
            mainWrapper.style.background = "rgba(255,255,255,0.1)";
            setTimeout(() => { mainWrapper.style.background = "transparent"; }, 300);
            
            // 위치가 바뀌면 현재 포커스된 입력창 유지
            if(document.activeElement.tagName === 'INPUT') document.activeElement.focus();
        }

        initGame();
    </script>
</body>
</html>
