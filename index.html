<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>타자 전략 시뮬레이션: 영토 전쟁</title>
    <style>
        body { background: #1a1a1a; color: white; display: flex; flex-direction: column; align-items: center; font-family: 'Malgun Gothic', sans-serif; margin: 0; }
        
        /* 상단 상태바 */
        .status-bar { display: flex; gap: 50px; background: #333; padding: 20px; width: 100%; justify-content: center; border-bottom: 4px solid #444; }
        .res-box { text-align: center; padding: 10px 30px; border-radius: 10px; }
        .p1-res { background: #2980b9; }
        .p2-res { background: #c0392b; }
        .res-val { font-size: 2rem; font-weight: bold; }

        /* 메인 레이아웃 */
        #main-wrapper { display: flex; gap: 30px; align-items: center; margin-top: 30px; transition: all 0.5s ease; }
        
        .player-zone { width: 220px; padding: 20px; border-radius: 15px; text-align: center; }
        .p1-zone { border: 3px solid #3498db; }
        .p2-zone { border: 3px solid #e74c3c; }
        input { width: 100%; padding: 12px; font-size: 1.2rem; border-radius: 8px; border: none; margin-top: 10px; text-align: center; }

        /* 전략 보드 */
        .board { display: grid; grid-template-columns: repeat(4, 150px); grid-template-rows: repeat(4, 110px); gap: 10px; }
        
        .cell {
            background: #2c3e50; border-radius: 8px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; position: relative;
            transition: all 0.3s; border-bottom: 5px solid #1a252f;
        }

        /* 영토별 상태 표시 */
        .owner-p1 { background: #3498db !important; border-bottom-color: #2980b9; }
        .owner-p2 { background: #e74c3c !important; border-bottom-color: #c0392b; }
        
        .level-badge { position: absolute; top: 5px; right: 8px; background: rgba(0,0,0,0.5); padding: 2px 6px; border-radius: 10px; font-size: 0.8rem; }
        .word-display { font-size: 1.3rem; font-weight: bold; margin-top: 5px; }
        .income-display { font-size: 0.8rem; opacity: 0.8; }

        /* 위치 교체 경고 */
        #swap-alert { color: #f1c40f; font-weight: bold; height: 30px; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="status-bar">
        <div class="res-box p1-res">
            <div>Blue 자금 (P1)</div>
            <div id="p1-money" class="res-val">0</div>
        </div>
        <div style="text-align: center;">
            <h2>TERRITORY WAR</h2>
            <div id="swap-alert">위치 교대까지 10초</div>
        </div>
        <div class="res-box p2-res">
            <div>Red 자금 (P2)</div>
            <div id="p2-money" class="res-val">0</div>
        </div>
    </div>

    <div id="main-wrapper">
        <div id="p1-area" class="player-zone p1-zone">
            <h3>P1 입력</h3>
            <input type="text" id="p1-input" placeholder="단어 입력" autofocus>
            <p style="font-size: 0.8rem; margin-top: 10px;">내 땅 입력 시 LV UP!<br>상대 땅 입력 시 약탈!</p>
        </div>

        <div class="board" id="board"></div>

        <div id="p2-area" class="player-zone p2-zone">
            <h3>P2 입력</h3>
            <input type="text" id="p2-input" placeholder="단어 입력">
            <p style="font-size: 0.8rem; margin-top: 10px;">상대 모니터를 확인하세요!</p>
        </div>
    </div>

    <script>
        const words = ["벽돌", "나무", "철광", "밀밭", "양모", "금광", "항구", "마을", "성곽", "시장", "도로", "요새", "사원", "농장", "숲속", "광산"];
        let boardData = [];
        let p1Money = 0;
        let p2Money = 0;
        let timeLeft = 10;
        let isSwapped = false;

        function initGame() {
            boardData = words.map(w => ({
                word: w,
                owner: null,
                level: 1
            }));
            renderBoard();
            setInterval(produceResources, 2000); // 2초마다 자원 생산
            setInterval(updateTimer, 1000);     // 1초마다 타이머
        }

        function renderBoard() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';
            boardData.forEach((data) => {
                const cell = document.createElement('div');
                cell.className = 'cell';
                if (data.owner === 'p1') cell.classList.add('owner-p1');
                if (data.owner === 'p2') cell.classList.add('owner-p2');

                cell.innerHTML = `
                    <span class="level-badge">LV.${data.level}</span>
                    <span class="word-display">${data.word}</span>
                    <span class="income-display">+$${data.level * 10}</span>
                `;
                boardEl.appendChild(cell);
            });
            document.getElementById('p1-money').innerText = p1Money;
            document.getElementById('p2-money').innerText = p2Money;
        }

        function handleInput(e, player) {
            if (e.key === 'Enter') {
                const val = e.target.value.trim();
                const target = boardData.find(d => d.word === val);
                
                if (target) {
                    if (target.owner === player) {
                        // 1. 투자: 내 땅이면 레벨업
                        target.level++;
                    } else if (target.owner === null) {
                        // 2. 점령: 빈 땅이면 내 소유로
                        target.owner = player;
                    } else {
                        // 3. 약탈: 상대 땅이면 자원 뺏기 및 소유권 이전
                        if (player === 'p1') {
                            p1Money += (target.level * 20);
                            p2Money = Math.max(0, p2Money - (target.level * 20));
                        } else {
                            p2Money += (target.level * 20);
                            p1Money = Math.max(0, p1Money - (target.level * 20));
                        }
                        target.owner = player;
                        target.level = 1; // 뺏으면 레벨 초기화
                    }
                    renderBoard();
                }
                e.target.value = '';
            }
        }

        function produceResources() {
            boardData.forEach(d => {
                if (d.owner === 'p1') p1Money += (d.level * 5);
                if (d.owner === 'p2') p2Money += (d.level * 5);
            });
            renderBoard();
        }

        function updateTimer() {
            timeLeft--;
            document.getElementById('swap-alert').innerText = `위치 교대까지 ${timeLeft}초`;
            if (timeLeft <= 0) {
                isSwapped = !isSwapped;
                document.getElementById('main-wrapper').style.flexDirection = isSwapped ? "row-reverse" : "row";
                timeLeft = 10;
            }
        }

        document.getElementById('p1-input').addEventListener('keypress', (e) => handleInput(e, 'p1'));
        document.getElementById('p2-input').addEventListener('keypress', (e) => handleInput(e, 'p2'));

        initGame();
    </script>
</body>
</html>
